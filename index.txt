Решение поделено на три части в соответствии с заданием.
Шаги пронумерованы в соответствии с шагами в задании